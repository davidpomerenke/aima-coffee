<!DOCTYPE html>

<html>
<head>
  <title>aima-coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="public/stylesheets/normalize.css" />
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div class="container">
    <div class="page">

      <div class="header">
        
          
          <h1 id="aima-coffee">aima-coffee</h1>
<p align="center">
  <a href="https://www.npmjs.com/package/aima">
    <img src="https://img.shields.io/npm/v/aima.svg" alt="NPM Package" />
  </a>
  <a href="https://github.com/davidpomerenke/aima.js/actions?query=workflow%3A%22Node+CI%22">
    <img src="https://github.com/davidpomerenke/aima.js/workflows/Node%20CI/badge.svg" alt="Tests" />
  </a>
  <a href="https://gitter.im/aima-js/community?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge">
    <img src="https://badges.gitter.im/aima-js/community.svg" alt="Chat" />
  </a>
</p>

<p><a href="http://aima.cs.berkeley.edu/"><em>Artificial Intelligence - A Modern Approach</em></a> (<em>AIMA</em>) by Stuart Russell and Peter Norvig is the reference textbook on artificial intelligence. </p>
<p>This package implements some of the algorithms and data structures from the <em>AIMA</em> book in literate, function-oriented <a href="https://coffeescript.org/">CoffeeScript</a>, which is compatible with JavaScript.
The focus is on code understandability. </p>
<h2 id="installation-and-usage">Installation and Usage</h2>
<p>For using this package as a module in your own Node JavaScript project, install it with the <a href="https://github.com/npm/cli">node package manager</a>:</p>
<p><code>npm install aima</code></p>
<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { Problem, makeEightPuzzle, aStarSearch } <span class="hljs-keyword">from</span> <span class="hljs-string">'aima'</span>

<span class="hljs-keyword">const</span> simpleEightPuzzle = makeEightPuzzle([
  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>],
  [<span class="hljs-number">6</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>],
  [<span class="hljs-number">8</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>]
])

<span class="hljs-built_in">console</span>.log(Problem.solutionPath(aStarSearch(simpleEightPuzzle)))</code></pre>
<p>Put the above example code in <code>example.mjs</code> and run it: </p>
<p><code>node example.mjs</code></p>
<h2 id="related-work">Related Work</h2>
<p>To my knowledge, there are exactly two other JavaScript projects related to <em>AIMA</em>: </p>
<ul>
<li><p><a href="https://github.com/aimacode/aima-javascript">aimacode/aima-javascript</a> is an implementation maintained by <em>AIMA</em> co-author Peter Norvig.
Its aim is to power some beautiful <a href="http://aimacode.github.io/aima-javascript/">interactive visualizations</a>.
It is written in browser JavaScript rather than Node Java- / CoffeeScript.
The <em>aimacode</em> organization also features repositories with <em>AIMA</em> implementations in other programming languages, notably 
<a href="https://github.com/aimacode/aima-java">Java</a> and 
<a href="https://github.com/aimacode/aima-python">Python</a>. </p>
</li>
<li><p><a href="https://github.com/ajlopez/NodeAima">ajlopez/NodeAima</a> is an abandoned implementation of only the <em>vacuum world</em> in Node JavaScript. </p>
</li>
</ul>
<p>The existing code from these projects still has to be harnessed for this project! </p>
<h2 id="extensions">Extensions</h2>
<ul>
<li><a href="https://github.com/davidpomerenke/aima-checkers">aima-checkers</a>: Checkers rulebase.</li>
</ul>
<h2 id="applications">Applications</h2>
<ul>
<li><a href="https://github.com/davidpomerenke/aima-checkers-gui">aima-checkers-gui</a>: Graphical checkers browsergame for desktop and mobile.</li>
</ul>
<h2 id="contributing">Contributing</h2>
<p>Every contribution is very welcome: Modifications of existing code to make it more understandable and beautiful; additional algorithms and data structures from the book; additional problems and games; additional usage examples; additional documentation; anything else you have in mind. Please create an issue or a pull request!</p>
<p>Thank you very much in advance for your contribution :)</p>
<h2 id="pre-requisites">Pre-Requisites</h2>
<h3 id="dependencies">Dependencies</h3>

          
            <div class='highlight'><pre><span class="hljs-keyword">import</span> deepEqual            <span class="hljs-keyword">from</span> <span class="hljs-string">'deep-equal'</span>
<span class="hljs-keyword">import</span> gen                  <span class="hljs-keyword">from</span> <span class="hljs-string">'random-seed'</span>
<span class="hljs-keyword">import</span> { strict <span class="hljs-keyword">as</span> assert } <span class="hljs-keyword">from</span> <span class="hljs-string">'assert'</span></pre></div>
          
        

        
      </div>

      
        
        <h3 id="utilities">Utilities</h3>
<h4 id="sum">Sum</h4>

        
          <div class='highlight'><pre><span class="hljs-function"><span class="hljs-title">sum</span> = <span class="hljs-params">(array, func)</span> -&gt;</span>
  array.reduce (<span class="hljs-function"><span class="hljs-params">(accumulator, value, index)</span> -&gt;</span>
    accumulator + func value, index, array), <span class="hljs-number">0</span></pre></div>
        
      
        
        
        
          <div class='highlight'><pre>array = [ [<span class="hljs-number">100</span>, <span class="hljs-number">1000</span>], [<span class="hljs-number">200</span>, <span class="hljs-number">2000</span>], [<span class="hljs-number">300</span>, <span class="hljs-number">3000</span>] ]
assert.equal (sum array, <span class="hljs-function"><span class="hljs-params">(x)</span>           -&gt;</span> x[<span class="hljs-number">1</span>]),                        <span class="hljs-number">6000</span>
assert.equal (sum array, <span class="hljs-function"><span class="hljs-params">(x, i)</span>        -&gt;</span> x[<span class="hljs-number">1</span>] + <span class="hljs-number">10</span> * i),               <span class="hljs-number">6030</span>
assert.equal (sum array, <span class="hljs-function"><span class="hljs-params">(x, i, array)</span> -&gt;</span> x[<span class="hljs-number">1</span>] + <span class="hljs-number">10</span> * i + array[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]), <span class="hljs-number">6330</span></pre></div>
        
      
        
        <h4 id="factorial">Factorial</h4>

        
          <div class='highlight'><pre><span class="hljs-function"><span class="hljs-title">factorial</span> = <span class="hljs-params">(n)</span> -&gt;</span> 
  [...Array(n).keys()]
    .reduce (<span class="hljs-function"><span class="hljs-params">(prev, i)</span> -&gt;</span> prev * (i + <span class="hljs-number">1</span>)), <span class="hljs-number">1</span></pre></div>
        
      
        
        
        
          <div class='highlight'><pre>assert.equal factorial(<span class="hljs-number">5</span>), <span class="hljs-number">1</span> * <span class="hljs-number">2</span> * <span class="hljs-number">3</span> * <span class="hljs-number">4</span> * <span class="hljs-number">5</span>
assert.equal factorial(<span class="hljs-number">10</span>), factorial(<span class="hljs-number">5</span>) * <span class="hljs-number">6</span> * <span class="hljs-number">7</span> * <span class="hljs-number">8</span> * <span class="hljs-number">9</span> * <span class="hljs-number">10</span></pre></div>
        
      
        
        <h2 id="intelligent-agents">Intelligent Agents</h2>
<h4 id="table-driven-agent">Table-Driven Agent</h4>
<p>Confer section 2.4, p. 47.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TableDrivenAgent</span></span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@table = {})</span> -&gt;</span>
    @percepts = []

  action: <span class="hljs-function"><span class="hljs-params">(percept)</span> -&gt;</span>
    @percepts.push percept
    @table[<span class="hljs-keyword">this</span>.percepts]</pre></div>
        
      
        
        <p>Example: <strong>Table Vacuum Agent</strong></p>

        
          <div class='highlight'><pre>tableVacuumAgent = <span class="hljs-keyword">new</span> TableDrivenAgent
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'right'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>
  [ [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'left'</span>
  [ [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'right'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'left'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'B'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'right'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>], [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'left'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>], [<span class="hljs-string">'B'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>
  [ [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'right'</span>
  [ [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>
  [ [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'left'</span>
  [ [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'B'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>
  [ [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'right'</span>
  [ [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>
  [ [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'left'</span>
  [ [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'B'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>] ] ]: <span class="hljs-string">'right'</span>
  [ [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>], [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>] ] ]: <span class="hljs-string">'suck'</span>  <span class="hljs-comment">#...</span></pre></div>
        
      
        
        
        
          <div class='highlight'><pre>assert.equal tableVacuumAgent.action([ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>] ]), <span class="hljs-string">'suck'</span>
assert.equal tableVacuumAgent.action([ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>] ]), <span class="hljs-string">'right'</span>
assert.equal tableVacuumAgent.action([ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'dirty'</span>] ]), <span class="hljs-literal">undefined</span></pre></div>
        
      
        
        <h4 id="simple-reflex-agent">Simple Reflex Agent</h4>
<p>Confer section 2.4, p. 49.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleReflexAgent</span></span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@rules)</span> -&gt;</span>

  action: <span class="hljs-function"><span class="hljs-params">(percept)</span> -&gt;</span>
    state = @interpretInput percept
    rule  = @rules.find (rule) -&gt;
      rule.condition ...state
    rule?.action

  interpretInput: <span class="hljs-function"><span class="hljs-params">(percept)</span> -&gt;</span>
    percept</pre></div>
        
      
        
        <p>Example: <strong>Reflex Vacuum Agent</strong></p>

        
          <div class='highlight'><pre>reflexVacuumAgent = <span class="hljs-keyword">new</span> SimpleReflexAgent [
  condition: <span class="hljs-function"><span class="hljs-params">([..., status  ])</span> -&gt;</span> status   == <span class="hljs-string">'dirty'</span>
  action: <span class="hljs-string">'suck'</span>
,
  condition: <span class="hljs-function"><span class="hljs-params">([location, ...])</span> -&gt;</span> location == <span class="hljs-string">'A'</span>
  action: <span class="hljs-string">'right'</span>
,	
  condition: <span class="hljs-function"><span class="hljs-params">([location, ...])</span> -&gt;</span> location == <span class="hljs-string">'B'</span>
  action: <span class="hljs-string">'left'</span>
]</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>assert.equal (reflexVacuumAgent.action [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'dirty'</span>] ]), <span class="hljs-string">'suck'</span>
assert.equal (reflexVacuumAgent.action [ [<span class="hljs-string">'A'</span>, <span class="hljs-string">'clean'</span>] ]), <span class="hljs-string">'right'</span>
assert.equal (reflexVacuumAgent.action [ [<span class="hljs-string">'B'</span>, <span class="hljs-string">'dirty'</span>] ]), <span class="hljs-string">'suck'</span>
assert.equal (reflexVacuumAgent.action [ [<span class="hljs-string">'C'</span>, <span class="hljs-string">'dirty'</span>] ]), <span class="hljs-string">'suck'</span>
assert.equal (reflexVacuumAgent.action [ [<span class="hljs-string">'C'</span>, <span class="hljs-string">'clean'</span>] ]), <span class="hljs-literal">undefined</span></pre></div>
        
      
        
        <h2 id="problem-solving">Problem Solving</h2>
<p>For the node structure, confer section 3.3.1, p. 79.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Problem</span></span>
  constructor: <span class="hljs-function"><span class="hljs-params">({ @initialState, @actions, result })</span> -&gt;</span>
    @_result = result

  result: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> @actions(state).some (a) -&gt; deepEqual action, a
      @_result state, action

  rootNode: <span class="hljs-function">-&gt;</span>
    state: @initialState

  childNode: <span class="hljs-function"><span class="hljs-params">(node, action)</span> -&gt;</span> {
    state:  @result node.state, action
    parent: node
    action: action
  }

  expand: <span class="hljs-function"><span class="hljs-params">(node)</span> -&gt;</span>
    @childNode(node, action) <span class="hljs-keyword">for</span> action <span class="hljs-keyword">in</span> @actions(node.state)

  @solutionPath: <span class="hljs-function"><span class="hljs-params">(node)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-string">'parent'</span> <span class="hljs-keyword">of</span> node
      [...Problem.solutionPath(node.parent), node.state]
    <span class="hljs-keyword">else</span>
      [node.state]</pre></div>
        
      
        
        <h2 id="search">Search</h2>
<p>Confer section 3.1.1, p. 67.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SearchProblem</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Problem</span></span>
  constructor: <span class="hljs-function"><span class="hljs-params">({ initialState, actions, result, stepCost, @heuristic = (-&gt; <span class="hljs-number">0</span>), @goalTest })</span> -&gt;</span>
    <span class="hljs-keyword">super</span>
      initialState: initialState,
      actions:      actions,
      result:       result
    @_stepCost = stepCost

  stepCost: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span>
    <span class="hljs-keyword">this</span>._stepCost state, action <span class="hljs-keyword">if</span> (@actions state).some (a) -&gt; deepEqual action, a

  rootNode: <span class="hljs-function">-&gt;</span> {
    ...<span class="hljs-keyword">super</span>()
    pathCost:  <span class="hljs-number">0</span>
    heuristic: @heuristic @initialState
  }

  childNode: <span class="hljs-function"><span class="hljs-params">(node, action)</span> -&gt;</span> {
    ...<span class="hljs-keyword">super</span> node, action
    pathCost:  node.pathCost + @stepCost node.state, action
    heuristic: @heuristic @result node.state, action
  }</pre></div>
        
      
        
        <h3 id="toy-problems">Toy Problems</h3>
<h4 id="vacuum-world">Vacuum World</h4>
<p>Confer section 3.2.1, p. 70.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> vacuumWorld = <span class="hljs-keyword">new</span> SearchProblem
  initialState: 
    location: <span class="hljs-string">'A'</span>
    A:        <span class="hljs-string">'dirty'</span>
    B:        <span class="hljs-string">'dirty'</span>
  actions: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span> [
    <span class="hljs-string">'left'</span>
    <span class="hljs-string">'right'</span>
    <span class="hljs-string">'suck'</span>
  ]
  result: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span>
    location:
      <span class="hljs-keyword">if</span> action == <span class="hljs-string">'left'</span>
        <span class="hljs-string">'A'</span>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> action == <span class="hljs-string">'right'</span>
        <span class="hljs-string">'B'</span>
      <span class="hljs-keyword">else</span>
        state.location
    A: 
      <span class="hljs-keyword">if</span> state.location == <span class="hljs-string">'A'</span> <span class="hljs-keyword">and</span> action == <span class="hljs-string">'suck'</span>
        <span class="hljs-string">'clean'</span>
      <span class="hljs-keyword">else</span>
        state.A
    B: 
      <span class="hljs-keyword">if</span> state.location == <span class="hljs-string">'B'</span> <span class="hljs-keyword">and</span> action == <span class="hljs-string">'suck'</span>
        <span class="hljs-string">'clean'</span>
      <span class="hljs-keyword">else</span>
        state.B
  stepCost: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span> <span class="hljs-number">1</span>
  goalTest: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
    state.A == <span class="hljs-string">'clean'</span> <span class="hljs-keyword">and</span>
    state.B == <span class="hljs-string">'clean'</span></pre></div>
        
      
        
        
        
          <div class='highlight'><pre>state = vacuumWorld.initialState
assert.deepEqual state, { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'dirty'</span>, B: <span class="hljs-string">'dirty'</span> }

state = vacuumWorld.result state, <span class="hljs-string">'suck'</span>
assert.deepEqual state, { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }

state = vacuumWorld.result state, <span class="hljs-string">'suck'</span>
assert.deepEqual state, { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }

state = vacuumWorld.result state, <span class="hljs-string">'left'</span>
assert.deepEqual state, { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }

state = vacuumWorld.result state, <span class="hljs-string">'right'</span>
assert.deepEqual state, { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
assert <span class="hljs-keyword">not</span> vacuumWorld.goalTest state

state = vacuumWorld.result state, <span class="hljs-string">'suck'</span>
assert.deepEqual state, { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'clean'</span> }
assert vacuumWorld.goalTest state</pre></div>
        
      
        
        <h4 id="8-puzzle">8-Puzzle</h4>
<p>Confer section 3.2.1, p. 71.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> makeEightPuzzle = <span class="hljs-function"><span class="hljs-params">(initialState)</span> -&gt;</span>
<span class="hljs-function">  <span class="hljs-title">moveIsValid</span> = <span class="hljs-params">(zero)</span> -&gt;</span>
    zero.y <span class="hljs-keyword">in</span> [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>] <span class="hljs-keyword">and</span>
    zero.x <span class="hljs-keyword">in</span> [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
<span class="hljs-function">
  <span class="hljs-title">zero</span> = <span class="hljs-params">(state)</span> -&gt;</span> <span class="hljs-comment"># position of zero</span>
    y: state.indexOf(state.filter(<span class="hljs-function"><span class="hljs-params">(row)</span> -&gt;</span> row.includes <span class="hljs-number">0</span>)[<span class="hljs-number">0</span>])
    x: state.filter(              <span class="hljs-function"><span class="hljs-params">(row)</span> -&gt;</span> row.includes <span class="hljs-number">0</span>)[<span class="hljs-number">0</span>].indexOf <span class="hljs-number">0</span>
<span class="hljs-function">
  <span class="hljs-title">goalPosition</span> = <span class="hljs-params">(nr)</span> -&gt;</span> [
    goalState.findIndex (row) -&gt; row.includes(nr)
    goalState.find(     <span class="hljs-function"><span class="hljs-params">(row)</span> -&gt;</span> row.includes(nr)).indexOf nr
  ]
<span class="hljs-function">
  <span class="hljs-title">manhattanDist</span> = <span class="hljs-params">([y1, x1], [y2, x2])</span> -&gt;</span>
    Math.abs(y1 - y2) +
    Math.abs(x1 - x2)

  moves =
    up:    { y: <span class="hljs-number">-1</span>, x:  <span class="hljs-number">0</span> }
    down:  { y:  <span class="hljs-number">1</span>, x:  <span class="hljs-number">0</span> }
    left:  { y:  <span class="hljs-number">0</span>, x: <span class="hljs-number">-1</span> }
    right: { y:  <span class="hljs-number">0</span>, x:  <span class="hljs-number">1</span> }

  goalState = [
    [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
    [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
    [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]
  ]

  <span class="hljs-keyword">new</span> SearchProblem
    initialState: initialState
    actions: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      Object.keys(moves)
        .filter (key) -&gt; moveIsValid
          y: (zero state).y + moves[key].y
          x: (zero state).x + moves[key].x
    result: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span>
      state.map (row, y) -&gt;
        row.map (nr, x) -&gt;</pre></div>
        
      
        
        <p>Shift zero to new position.</p>

        
          <div class='highlight'><pre>          <span class="hljs-keyword">if</span> y == (zero state).y + moves[action].y <span class="hljs-keyword">and</span>
          x    == (zero state).x + moves[action].x
            <span class="hljs-number">0</span></pre></div>
        
      
        
        <p>Shift number to old position of zero.</p>

        
          <div class='highlight'><pre>          <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> nr == <span class="hljs-number">0</span>
            state[(zero state).y + moves[action].y][(zero state).x + moves[action].x]</pre></div>
        
      
        
        <p>Keep all other numbers.</p>

        
          <div class='highlight'><pre>          <span class="hljs-keyword">else</span>
            nr
    stepCost: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span> <span class="hljs-number">1</span>
    heuristic: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      sum state, <span class="hljs-function"><span class="hljs-params">(numbers, y)</span> -&gt;</span>
        sum numbers, <span class="hljs-function"><span class="hljs-params">(number, x)</span> -&gt;</span>
          manhattanDist [y, x], goalPosition number
    goalTest: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      deepEqual state, goalState</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>simpleEightPuzzle = makeEightPuzzle [
  [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>]
  [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>]
  [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]
]

state = simpleEightPuzzle.initialState
assert.deepEqual state, [
  [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>]
  [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>]
  [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]
]
assert.equal (simpleEightPuzzle.heuristic state), <span class="hljs-number">4</span>

state = simpleEightPuzzle.result state, <span class="hljs-string">'up'</span>
assert.deepEqual state, [
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>]
  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
  [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]
]
assert.equal (simpleEightPuzzle.heuristic state), <span class="hljs-number">2</span>
assert <span class="hljs-keyword">not</span> simpleEightPuzzle.goalTest state

state = simpleEightPuzzle.result state, <span class="hljs-string">'left'</span>
assert.deepEqual state, [
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
  [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>]
]
assert.equal (simpleEightPuzzle.heuristic state), <span class="hljs-number">0</span>
assert simpleEightPuzzle.goalTest state</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>complexEightPuzzle = makeEightPuzzle [
  [<span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>]
  [<span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>]
  [<span class="hljs-number">8</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>]
]
state = complexEightPuzzle.initialState
assert.equal (simpleEightPuzzle.heuristic state), <span class="hljs-number">20</span></pre></div>
        
      
        
        <h4 id="incremental-8-queens-problem">Incremental 8-Queens Problem</h4>
<p>Incremental formulation of the 8-queens problem. Confer section 3.2.1, p. 72.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> incrementalEightQueensProblem = <span class="hljs-keyword">new</span> SearchProblem
  initialState: []
  actions: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
    y = state.length
    <span class="hljs-keyword">if</span> y &lt; <span class="hljs-number">8</span>
      [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>]
        .filter (x) -&gt;
          <span class="hljs-keyword">not</span> isAttacked [y, x], state
    <span class="hljs-keyword">else</span> []
  result: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span> [...state, action]
  stepCost: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span> <span class="hljs-number">0</span>
  goalTest: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span> state.length == <span class="hljs-number">8</span>
<span class="hljs-function">
<span class="hljs-title">isAttacked</span> = <span class="hljs-params">([y0, x0], state)</span> -&gt;</span>
  state.some (x, y) -&gt;
    x == x0 <span class="hljs-keyword">or</span>
    y == y0 <span class="hljs-keyword">or</span>
    Math.abs(y - y0) == Math.abs(x - x0)</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>state = incrementalEightQueensProblem.initialState

state = incrementalEightQueensProblem.result state, <span class="hljs-number">3</span>
assert.deepEqual state, [<span class="hljs-number">3</span>]
assert.deepEqual (incrementalEightQueensProblem.result state, <span class="hljs-number">3</span>), <span class="hljs-literal">undefined</span>

state = incrementalEightQueensProblem.result state, <span class="hljs-number">5</span>
assert.deepEqual state, [<span class="hljs-number">3</span>, <span class="hljs-number">5</span>]
assert.deepEqual (incrementalEightQueensProblem.result state, <span class="hljs-number">1</span>), <span class="hljs-literal">undefined</span></pre></div>
        
      
        
        <h4 id="knuth-conjecture">Knuth Conjecture</h4>
<p>Confer section 3.2.1, p. 73.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> makeKnuthConjecture = <span class="hljs-function"><span class="hljs-params">(goal)</span> -&gt;</span>
<span class="hljs-function">  <span class="hljs-title">calc</span> = <span class="hljs-params">(state)</span> -&gt;</span>
    state.reduce (total, operation) -&gt;
      <span class="hljs-keyword">if</span> operation.isNumber
        operation
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> operation == <span class="hljs-string">'factorial'</span>
        factorial total
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> operation == <span class="hljs-string">'square_root'</span>
        Math.sqrt total
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> operation == <span class="hljs-string">'floor'</span>
        Math.floor total
  <span class="hljs-keyword">new</span> SearchProblem
    initialState: [<span class="hljs-number">4</span>]
    actions: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      <span class="hljs-keyword">if</span> Number.isInteger calc(state)
        [<span class="hljs-string">'square_root'</span>, <span class="hljs-string">'factorial'</span>]
      <span class="hljs-keyword">else</span>
        [<span class="hljs-string">'square_root'</span>, <span class="hljs-string">'floor'</span>]
    result: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span> [...state, action],
    stepCost: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span> <span class="hljs-number">1</span>,
    goalTest: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span> (calc state) == goal</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>simpleKnuthConjecture  = makeKnuthConjecture <span class="hljs-number">1</span>
complexKnuthConjecture = makeKnuthConjecture <span class="hljs-number">5</span>

state = complexKnuthConjecture.initialState
assert.deepEqual state, [<span class="hljs-number">4</span>]

state = complexKnuthConjecture.result state, <span class="hljs-string">'factorial'</span>
state = complexKnuthConjecture.result state, <span class="hljs-string">'factorial'</span>
state = complexKnuthConjecture.result state, <span class="hljs-string">'square_root'</span>
state = complexKnuthConjecture.result state, <span class="hljs-string">'square_root'</span>
state = complexKnuthConjecture.result state, <span class="hljs-string">'square_root'</span>
state = complexKnuthConjecture.result state, <span class="hljs-string">'square_root'</span>

state = complexKnuthConjecture.result state, <span class="hljs-string">'square_root'</span>
assert <span class="hljs-keyword">not</span> complexKnuthConjecture.goalTest state

state = complexKnuthConjecture.result state, <span class="hljs-string">'floor'</span>
assert complexKnuthConjecture.goalTest state</pre></div>
        
      
        
        <h3 id="real-world-problems">Real World Problems</h3>
<p>Confer section 3.1, p. 68.</p>

        
          <div class='highlight'><pre>cities =
  dist:
    Arad:
      Zerind: <span class="hljs-number">75</span>
      Sibiu: <span class="hljs-number">140</span>
      Timisoara: <span class="hljs-number">118</span>
    Zerind:
      Arad: <span class="hljs-number">75</span>
      Oradea: <span class="hljs-number">71</span>
    Oradea:
      Zerind: <span class="hljs-number">71</span>
      Sibiu: <span class="hljs-number">151</span>
    Sibiu:
      Arad: <span class="hljs-number">140</span>
      Oradea: <span class="hljs-number">151</span>
      Fagaras: <span class="hljs-number">99</span>
      RimnicuVilcea: <span class="hljs-number">80</span>
    Fagaras:
      Sibiu: <span class="hljs-number">99</span>
      Bucharest: <span class="hljs-number">211</span>
    Bucharest:
      Fagaras: <span class="hljs-number">211</span>
      Urziceni: <span class="hljs-number">85</span>
      Giurgiu: <span class="hljs-number">90</span>
      Pitesti: <span class="hljs-number">101</span>
    Urziceni:
      Bucharest: <span class="hljs-number">85</span>
      Vaslui: <span class="hljs-number">142</span>
      Hirsova: <span class="hljs-number">98</span>
    Vaslui:
      Urziceni: <span class="hljs-number">142</span>
      Iasi: <span class="hljs-number">92</span>
    Iasi:
      Vaslui: <span class="hljs-number">92</span>
      Neamt: <span class="hljs-number">87</span>
    Neamt:
      Iasi: <span class="hljs-number">87</span>
    Hirsova:
      Urziceni: <span class="hljs-number">98</span>
      Eforie: <span class="hljs-number">86</span>
    Eforie:
      Hirsova: <span class="hljs-number">86</span>
    Giurgiu:
      Bucharest: <span class="hljs-number">90</span>
    Pitesti:
      Bucharest: <span class="hljs-number">101</span>
      Craiova: <span class="hljs-number">138</span>
      RimnicuVilcea: <span class="hljs-number">97</span>
    Craiova:
      Pitesti: <span class="hljs-number">138</span>
      Drobeta: <span class="hljs-number">120</span>
      RimnicuVilcea: <span class="hljs-number">146</span>
    Drobeta:
      Craiova: <span class="hljs-number">120</span>
      Mehadia: <span class="hljs-number">75</span>
    Mehadia:
      Drobeta: <span class="hljs-number">120</span>
      Lugoj: <span class="hljs-number">70</span>
    Lugoj:
      Mehadia: <span class="hljs-number">70</span>
      Timisoara: <span class="hljs-number">111</span>
    Timisoara:
      Lugoj: <span class="hljs-number">111</span>
      Arad: <span class="hljs-number">118</span>
    RimnicuVilcea:
      Sibiu: <span class="hljs-number">80</span>
      Pitesti: <span class="hljs-number">97</span>
      Craiova: <span class="hljs-number">146</span>
  straightLineDist:
    Bucharest:
      Arad: <span class="hljs-number">366</span>
      Mehadia: <span class="hljs-number">241</span>
      Bucharest: <span class="hljs-number">0</span>
      Neamt: <span class="hljs-number">234</span>
      Craiova: <span class="hljs-number">160</span>
      Oradea: <span class="hljs-number">380</span>
      Drobeta: <span class="hljs-number">242</span>
      Pitesti: <span class="hljs-number">100</span>
      Eforie: <span class="hljs-number">161</span>
      RimnicuVilcea: <span class="hljs-number">193</span>
      Fagaras: <span class="hljs-number">176</span>
      Sibiu: <span class="hljs-number">253</span>
      Giurgiu: <span class="hljs-number">77</span>
      Timisoara: <span class="hljs-number">329</span>
      Hirsova: <span class="hljs-number">151</span>
      Urziceni: <span class="hljs-number">80</span>
      Iasi: <span class="hljs-number">226</span>
      Vaslui: <span class="hljs-number">199</span>
      Lugoj: <span class="hljs-number">244</span>
      Zerind: <span class="hljs-number">374</span>
    Arad:
      Bucharest: <span class="hljs-number">366</span>
    Mehadia:
      Bucharest: <span class="hljs-number">241</span>
    Neamt:
      Bucharest: <span class="hljs-number">234</span>
    Craiova:
      Bucharest: <span class="hljs-number">160</span>
    Oradea:
      Bucharest: <span class="hljs-number">380</span>
    Drobeta:
      Bucharest: <span class="hljs-number">242</span>
    Pitesti:
      Bucharest: <span class="hljs-number">100</span>
    Eforie:
      Bucharest: <span class="hljs-number">161</span>
    RimnicuVilcea:
      Bucharest: <span class="hljs-number">193</span>
    Fagaras:
      Bucharest: <span class="hljs-number">176</span>
    Sibiu:
      Bucharest: <span class="hljs-number">253</span>
    Giurgiu:
      Bucharest: <span class="hljs-number">77</span>
    Timisoara:
      Bucharest: <span class="hljs-number">329</span>
    Hirsova:
      Bucharest: <span class="hljs-number">151</span>
    Urziceni:
      Bucharest: <span class="hljs-number">80</span>
    Iasi:
      Bucharest: <span class="hljs-number">226</span>
    Vaslui:
      Bucharest: <span class="hljs-number">199</span>
    Lugoj:
      Bucharest: <span class="hljs-number">244</span>
    Zerind:
      Bucharest: <span class="hljs-number">374</span></pre></div>
        
      
        
        <h4 id="route-finding-problem">Route Finding Problem</h4>
<p>Confer section 3.2.2, p. 73.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> makeRouteFindingProblem = <span class="hljs-function"><span class="hljs-params">(graph, start, end)</span> -&gt;</span>
  <span class="hljs-keyword">new</span> SearchProblem
    initialState: start
    actions: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      Object.keys graph.dist[state]
    result: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span>
      action <span class="hljs-keyword">if</span> action <span class="hljs-keyword">of</span> graph.dist[state]
    stepCost: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span>
      graph.dist[state][action]
    heuristic: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      graph.straightLineDist[state][end]
    goalTest: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      deepEqual state, end</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>routeFindingProblem = makeRouteFindingProblem cities, <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Bucharest'</span>

state = routeFindingProblem.initialState
assert.equal state, <span class="hljs-string">'Arad'</span>
assert.equal (routeFindingProblem.stepCost state, <span class="hljs-string">'Sibiu'</span>), <span class="hljs-number">140</span>

state = routeFindingProblem.result state, <span class="hljs-string">'Sibiu'</span>
assert.equal state, <span class="hljs-string">'Sibiu'</span>
assert.equal (routeFindingProblem.stepCost state, <span class="hljs-string">'RimnicuVilcea'</span>), <span class="hljs-number">80</span>

state = routeFindingProblem.result state, <span class="hljs-string">'RimnicuVilcea'</span>
assert.equal state, <span class="hljs-string">'RimnicuVilcea'</span>
assert.equal (routeFindingProblem.stepCost state, <span class="hljs-string">'Arad'</span>), <span class="hljs-literal">undefined</span>

state = routeFindingProblem.result state, <span class="hljs-string">'Arad'</span>
assert.equal state, <span class="hljs-literal">undefined</span></pre></div>
        
      
        
        <h4 id="touring-problem">Touring Problem</h4>
<p>Confer section 3.2.2, p. 74.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> makeTouringProblem = <span class="hljs-function"><span class="hljs-params">(graph, start, end)</span> -&gt;</span>
  <span class="hljs-keyword">new</span> SearchProblem
    initialState: [start]
    actions: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      Object.keys graph.dist[state[state.length - <span class="hljs-number">1</span>]]
        .filter (city) -&gt; <span class="hljs-keyword">not</span> state.includes city
    result: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span>
      <span class="hljs-keyword">if</span> action <span class="hljs-keyword">of</span> graph.dist[state[state.length - <span class="hljs-number">1</span>]]
        [...state, action]
    stepCost: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span>
      graph.dist[state[state.length - <span class="hljs-number">1</span>]][action]
    heuristic: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      graph.straightLineDist[state[state.length - <span class="hljs-number">1</span>]][end]
    goalTest: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      deepEqual state[state.length - <span class="hljs-number">1</span>], end</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>touringProblem = makeTouringProblem cities, <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Bucharest'</span>

state = touringProblem.initialState
assert.deepEqual state, [<span class="hljs-string">'Arad'</span>]
assert.equal (touringProblem.stepCost state, <span class="hljs-string">'Sibiu'</span>), <span class="hljs-number">140</span>

state = touringProblem.result state, <span class="hljs-string">'Sibiu'</span>
assert.deepEqual state, [<span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>]
assert.equal (touringProblem.stepCost state, <span class="hljs-string">'RimnicuVilcea'</span>), <span class="hljs-number">80</span>

state = touringProblem.result state, <span class="hljs-string">'RimnicuVilcea'</span>
assert.deepEqual state, [<span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'RimnicuVilcea'</span>]
assert.equal (touringProblem.stepCost state, <span class="hljs-string">'Sibiu'</span>), <span class="hljs-literal">undefined</span>

state = touringProblem.result state, <span class="hljs-string">'Sibiu'</span>
assert.deepEqual state, <span class="hljs-literal">undefined</span></pre></div>
        
      
        
        <h4 id="traveling-salesperson-problem">Traveling Salesperson Problem</h4>
<p>Confer section 3.2.2, p. 74.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> makeTravelingSalespersonProblem = <span class="hljs-function"><span class="hljs-params">(graph, start, end)</span> -&gt;</span>
  <span class="hljs-keyword">new</span> SearchProblem
    initialState: [start]
    actions: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      Object.keys graph.dist[state[state.length - <span class="hljs-number">1</span>]]
        .filter (city) -&gt; <span class="hljs-keyword">not</span> state.includes city
    result: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span> [...state, action]
    stepCost: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span>
      graph.dist[state[state.length - <span class="hljs-number">1</span>]][action]
    goalTest: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
      state.length == (Object.keys graph.dist).length <span class="hljs-keyword">and</span>
      state[state.length - <span class="hljs-number">1</span>] == end</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>travelingSalespersonProblem = makeTravelingSalespersonProblem cities, <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Bucharest'</span>

state = travelingSalespersonProblem.initialState
assert.deepEqual state, [<span class="hljs-string">'Arad'</span>]
assert.equal (travelingSalespersonProblem.stepCost state, <span class="hljs-string">'Sibiu'</span>), <span class="hljs-number">140</span>

state = travelingSalespersonProblem.result state, <span class="hljs-string">'Sibiu'</span>
assert.deepEqual state, [<span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>]
assert.equal (travelingSalespersonProblem.stepCost state, <span class="hljs-string">'Arad'</span>), <span class="hljs-literal">undefined</span>

state = travelingSalespersonProblem.result state, <span class="hljs-string">'Arad'</span>
assert.deepEqual state, <span class="hljs-literal">undefined</span></pre></div>
        
      
        
        <h3 id="tree-search">Tree Search</h3>
<p>Confer section 3.3, p. 77.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> makeTreeSearch = <span class="hljs-function"><span class="hljs-params">(Queue)</span> -&gt;</span>
  (problem) -&gt;
    frontier = <span class="hljs-keyword">new</span> Queue
    frontier.add problem.initialState.rootNode()
    <span class="hljs-keyword">while</span> frontier.length &gt; <span class="hljs-number">0</span>
      node = frontier.poll()
      <span class="hljs-keyword">if</span> problem.goalTest node.state
        <span class="hljs-keyword">return</span> node
      (frontier.add child) <span class="hljs-keyword">for</span> child <span class="hljs-keyword">of</span> problem.expand node
    <span class="hljs-literal">false</span></pre></div>
        
      
        
        <h3 id="graph-search">Graph Search</h3>
<p>Confer section 3.3, p. 77.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> makeGraphSearch = <span class="hljs-function"><span class="hljs-params">(Queue)</span> -&gt;</span>
  (problem) -&gt;
    frontier = <span class="hljs-keyword">new</span> Queue
    frontier.add problem.rootNode()
    explored = <span class="hljs-keyword">new</span> Set
    <span class="hljs-keyword">while</span> frontier.length() &gt; <span class="hljs-number">0</span>
      node = frontier.poll()
      <span class="hljs-keyword">if</span> problem.goalTest node.state
        <span class="hljs-keyword">return</span> node
      explored.add node
      <span class="hljs-keyword">for</span> child <span class="hljs-keyword">in</span> problem.expand node
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> explored.has child) <span class="hljs-keyword">and</span>
        <span class="hljs-keyword">not</span> frontier.some (node) -&gt; node.state == child.state
          frontier.add child
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> frontier.constructor.name == <span class="hljs-string">'PriorityQueue'</span>
          frontierChild = frontier
            .find (node) -&gt; deepEqual node.state, child.state
          <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> frontierChild != <span class="hljs-string">'undefined'</span> <span class="hljs-keyword">and</span>
          frontierChild.pathCost &gt; child.pathCost
            frontier.replace frontierChild, child
    <span class="hljs-literal">false</span></pre></div>
        
      
        
        <h4 id="queues">Queues</h4>
<p>Confer section 3.3.1, p. 80.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Queue</span></span>
  constructor: <span class="hljs-function">-&gt;</span>
    @queue = []

  add: <span class="hljs-function"><span class="hljs-params">(item)</span> -&gt;</span>
    @queue.push item

  some: <span class="hljs-function"><span class="hljs-params">(func)</span> -&gt;</span>
    @queue.some func

  find: <span class="hljs-function"><span class="hljs-params">(func)</span> -&gt;</span>
    @queue.find func

  replace: <span class="hljs-function"><span class="hljs-params">(a, b)</span> -&gt;</span>
    @queue[@queue.indexOf a] = b

  length: <span class="hljs-function">-&gt;</span>
    @queue.length</pre></div>
        
      
        
        <h4 id="fifo-queue">FIFO Queue</h4>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FifoQueue</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Queue</span></span>
  poll: <span class="hljs-function">-&gt;</span>
    @queue.shift()</pre></div>
        
      
        
        <h4 id="lifo-queue-stack">LIFO Queue (Stack)</h4>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LifoQueue</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Queue</span></span>
  poll: <span class="hljs-function">-&gt;</span>
    @queue.pop()</pre></div>
        
      
        
        <h4 id="priority-queue">Priority Queue</h4>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> makePriorityQueue = <span class="hljs-function"><span class="hljs-params">(mapFunc)</span> -&gt;</span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PriorityQueue</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Queue</span></span>
    constructor: <span class="hljs-function">-&gt;</span>
      <span class="hljs-keyword">super</span>()
      @mapFunc = mapFunc
      @sortFunc = <span class="hljs-function"><span class="hljs-params">(a, b)</span> -&gt;</span> mapFunc(a) - mapFunc(b)

    poll: <span class="hljs-function">-&gt;</span>
      @queue = @queue.sort @sortFunc
      @queue.shift()

    sort: <span class="hljs-function">-&gt;</span>
      @queue = @queue.sort @sortFunc</pre></div>
        
      
        
        <h3 id="uninformed-search">Uninformed Search</h3>
<h4 id="breadth-first-search">Breadth-First Search</h4>
<p>Confer section 3.4.1, p. 82.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> breadthFirstSearch = makeGraphSearch FifoQueue</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
assert.deepEqual (Problem.solutionPath breadthFirstSearch vacuumWorld), [
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'dirty'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'clean'</span> }]
assert.deepEqual (Problem.solutionPath breadthFirstSearch simpleEightPuzzle), [
  [ [ <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]
  [ [ <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]
  [ [ <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ] ]
assert.deepEqual (breadthFirstSearch incrementalEightQueensProblem).state, [
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
].map (row) -&gt; row.indexOf <span class="hljs-number">1</span>
assert.deepEqual (breadthFirstSearch simpleKnuthConjecture).state, \
  [<span class="hljs-number">4</span>, <span class="hljs-string">'square_root'</span>, <span class="hljs-string">'square_root'</span>, <span class="hljs-string">'floor'</span>]
assert.deepEqual (Problem.solutionPath breadthFirstSearch routeFindingProblem), \
  [ <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'Fagaras'</span>, <span class="hljs-string">'Bucharest'</span> ]
assert.deepEqual (breadthFirstSearch touringProblem).state, \
  [ <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'Fagaras'</span>, <span class="hljs-string">'Bucharest'</span> ]
assert.equal (breadthFirstSearch travelingSalespersonProblem), <span class="hljs-literal">false</span></pre></div>
        
      
        
        <h4 id="uniform-cost-search">Uniform Cost Search</h4>
<p>Confer section 3.4.2, p. 84.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> uniformCostSearch = makeGraphSearch makePriorityQueue (node) -&gt; node.pathCost</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
assert.deepEqual (Problem.solutionPath uniformCostSearch vacuumWorld), [
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'dirty'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'clean'</span> }]
assert.deepEqual (Problem.solutionPath uniformCostSearch simpleEightPuzzle), [
  [ [ <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]
  [ [ <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]
  [ [ <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]]
assert.deepEqual (uniformCostSearch incrementalEightQueensProblem).state, [
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
].map (row) -&gt; row.indexOf <span class="hljs-number">1</span>
assert.deepEqual (uniformCostSearch simpleKnuthConjecture).state, \
  [<span class="hljs-number">4</span>, <span class="hljs-string">'square_root'</span>, <span class="hljs-string">'square_root'</span>, <span class="hljs-string">'floor'</span>]
assert.deepEqual (Problem.solutionPath uniformCostSearch routeFindingProblem), \
  [ <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'RimnicuVilcea'</span>, <span class="hljs-string">'Pitesti'</span>, <span class="hljs-string">'Bucharest'</span> ]
assert.deepEqual (uniformCostSearch touringProblem).state, \
  [ <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'RimnicuVilcea'</span>, <span class="hljs-string">'Pitesti'</span>, <span class="hljs-string">'Bucharest'</span> ]
assert.equal (uniformCostSearch travelingSalespersonProblem), <span class="hljs-literal">false</span></pre></div>
        
      
        
        <h4 id="depth-first-search">Depth-First Search</h4>
<p>Confer section 3.4.3, p. 87.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> depthFirstSearch = makeGraphSearch LifoQueue</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
assert.deepEqual (depthFirstSearch incrementalEightQueensProblem).state, [
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
].map (row) -&gt; row.indexOf <span class="hljs-number">1</span>
assert.deepEqual (depthFirstSearch touringProblem).state, [
  <span class="hljs-string">'Arad'</span>,
  <span class="hljs-string">'Timisoara'</span>,
  <span class="hljs-string">'Lugoj'</span>,
  <span class="hljs-string">'Mehadia'</span>,
  <span class="hljs-string">'Drobeta'</span>,
  <span class="hljs-string">'Craiova'</span>,
  <span class="hljs-string">'RimnicuVilcea'</span>,
  <span class="hljs-string">'Pitesti'</span>,
  <span class="hljs-string">'Bucharest'</span>
] <span class="hljs-comment"># depends on the (arbitrary) order of attributes in the cities graph</span>
assert.equal (depthFirstSearch travelingSalespersonProblem), <span class="hljs-literal">false</span></pre></div>
        
      
        
        <h4 id="depth-limited-search">Depth-Limited Search</h4>
<p>Confer section 3.4.4, p. 88.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> depthLimitedSearch = <span class="hljs-function"><span class="hljs-params">(problem, limit)</span> -&gt;</span>
  recursiveDepthLimitedSearch problem.rootNode(), problem, limit
<span class="hljs-function">
<span class="hljs-title">recursiveDepthLimitedSearch</span> = <span class="hljs-params">(node, problem, limit)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> problem.goalTest node.state
    node
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> limit == <span class="hljs-number">0</span>
    <span class="hljs-string">'cutoff'</span>
  <span class="hljs-keyword">else</span>
    cutoffOccurred = <span class="hljs-literal">false</span>
    <span class="hljs-keyword">for</span> child <span class="hljs-keyword">in</span> problem.expand node
      result = recursiveDepthLimitedSearch child, problem, limit - <span class="hljs-number">1</span>
      <span class="hljs-keyword">if</span> result == <span class="hljs-string">'cutoff'</span>
        cutoffOccurred = <span class="hljs-literal">true</span>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> result
        <span class="hljs-keyword">return</span> result
    <span class="hljs-keyword">if</span> cutoffOccurred
      <span class="hljs-string">'cutoff'</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-literal">false</span></pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
assert.equal (depthLimitedSearch vacuumWorld, <span class="hljs-number">2</span>), <span class="hljs-string">'cutoff'</span>
assert.deepEqual (Problem.solutionPath (depthLimitedSearch vacuumWorld, <span class="hljs-number">3</span>)), [
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'dirty'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'clean'</span> }]

assert.equal (depthLimitedSearch simpleEightPuzzle, <span class="hljs-number">1</span>), <span class="hljs-string">'cutoff'</span>
assert simpleEightPuzzle.goalTest (depthLimitedSearch simpleEightPuzzle, <span class="hljs-number">2</span>).state

assert.deepEqual (depthLimitedSearch incrementalEightQueensProblem, <span class="hljs-number">8</span>).state, [
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
].map (row) -&gt; row.indexOf <span class="hljs-number">1</span>

assert.equal (depthLimitedSearch simpleKnuthConjecture, <span class="hljs-number">2</span>), <span class="hljs-string">'cutoff'</span>
assert (depthLimitedSearch simpleKnuthConjecture, <span class="hljs-number">3</span>).state, <span class="hljs-number">1</span>

assert.deepEqual (Problem.solutionPath (depthLimitedSearch routeFindingProblem, <span class="hljs-number">4</span>)), \
  [<span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'Fagaras'</span>, <span class="hljs-string">'Bucharest'</span>]

assert.deepEqual (depthLimitedSearch touringProblem, <span class="hljs-number">4</span>).state, \
  [<span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'Fagaras'</span>, <span class="hljs-string">'Bucharest'</span>]

assert.equal (depthLimitedSearch travelingSalespersonProblem, <span class="hljs-number">20</span>), <span class="hljs-literal">false</span></pre></div>
        
      
        
        <h4 id="iterative-deepening-search">Iterative Deepening Search</h4>
<p>Confer section 3.4.5, p. 89.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> iterativeDeepeningSearch = <span class="hljs-function"><span class="hljs-params">(problem)</span> -&gt;</span>
  recursiveIterativeDeepeningSearch problem, <span class="hljs-number">0</span>
<span class="hljs-function">
<span class="hljs-title">recursiveIterativeDeepeningSearch</span> = <span class="hljs-params">(problem, depth)</span> -&gt;</span>
  result = depthLimitedSearch problem, depth
  <span class="hljs-keyword">if</span> result != <span class="hljs-string">'cutoff'</span>
    result
  <span class="hljs-keyword">else</span>
    recursiveIterativeDeepeningSearch problem, (depth + <span class="hljs-number">1</span>)</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
assert.deepEqual (Problem.solutionPath iterativeDeepeningSearch vacuumWorld), [
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'dirty'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'clean'</span> }]
assert.deepEqual (Problem.solutionPath iterativeDeepeningSearch simpleEightPuzzle), [
  [ [ <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]
  [ [ <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]
  [ [ <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]]
assert.deepEqual (iterativeDeepeningSearch incrementalEightQueensProblem).state, [
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
].map (row) -&gt; row.indexOf <span class="hljs-number">1</span>
assert.deepEqual (iterativeDeepeningSearch simpleKnuthConjecture).state, \
  [<span class="hljs-number">4</span>, <span class="hljs-string">'square_root'</span>, <span class="hljs-string">'square_root'</span>, <span class="hljs-string">'floor'</span>]
assert.deepEqual (Problem.solutionPath iterativeDeepeningSearch routeFindingProblem), \
  [ <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'Fagaras'</span>, <span class="hljs-string">'Bucharest'</span> ]
assert.deepEqual (iterativeDeepeningSearch touringProblem).state, \
  [ <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'Fagaras'</span>, <span class="hljs-string">'Bucharest'</span> ]
assert.equal (iterativeDeepeningSearch travelingSalespersonProblem), <span class="hljs-literal">false</span></pre></div>
        
      
        
        <h3 id="heuristic-search">Heuristic Search</h3>
<h4 id="greedy-best-first-search">Greedy Best-First Search</h4>
<p>Confer section 3.5.1, p. 92.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> greedySearch = makeGraphSearch \
  makePriorityQueue (node) -&gt; node.heuristic</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
assert.deepEqual (Problem.solutionPath greedySearch vacuumWorld), [
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'dirty'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'clean'</span> }]
assert.deepEqual (Problem.solutionPath greedySearch simpleEightPuzzle), [
  [ [ <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]
  [ [ <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]
  [ [ <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]]
assert.deepEqual (greedySearch incrementalEightQueensProblem).state, [
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
].map (row) -&gt; row.indexOf <span class="hljs-number">1</span>
assert.deepEqual (greedySearch simpleKnuthConjecture).state, \
  [<span class="hljs-number">4</span>, <span class="hljs-string">'square_root'</span>, <span class="hljs-string">'square_root'</span>, <span class="hljs-string">'floor'</span>]
assert.deepEqual (Problem.solutionPath greedySearch routeFindingProblem), \
  [ <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'Fagaras'</span>, <span class="hljs-string">'Bucharest'</span> ]
assert.deepEqual (greedySearch touringProblem).state, \
  [ <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'Fagaras'</span>, <span class="hljs-string">'Bucharest'</span> ]
assert.equal (greedySearch travelingSalespersonProblem), <span class="hljs-literal">false</span></pre></div>
        
      
        
        <h4 id="a-search">A* Search</h4>
<p>Confer section 3.5.2, p. 93.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> aStarSearch  = makeGraphSearch \
  makePriorityQueue (node) -&gt; node.pathCost + node.heuristic</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
assert.deepEqual (Problem.solutionPath aStarSearch vacuumWorld), [
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'dirty'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'A'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'dirty'</span> }
  { location: <span class="hljs-string">'B'</span>, A: <span class="hljs-string">'clean'</span>, B: <span class="hljs-string">'clean'</span> }]
assert.deepEqual (Problem.solutionPath aStarSearch simpleEightPuzzle), [
  [ [ <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]
  [ [ <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]
  [ [ <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span> ]
    [ <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ]
    [ <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> ] ]]
assert.deepEqual (aStarSearch incrementalEightQueensProblem).state, [
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
].map (row) -&gt; row.indexOf <span class="hljs-number">1</span>
assert.deepEqual (aStarSearch simpleKnuthConjecture).state, \
  [<span class="hljs-number">4</span>, <span class="hljs-string">'square_root'</span>, <span class="hljs-string">'square_root'</span>, <span class="hljs-string">'floor'</span>]
assert.deepEqual (Problem.solutionPath aStarSearch routeFindingProblem), \
  [ <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'RimnicuVilcea'</span>, <span class="hljs-string">'Pitesti'</span>, <span class="hljs-string">'Bucharest'</span> ]
assert.deepEqual (aStarSearch touringProblem).state, \
  [ <span class="hljs-string">'Arad'</span>, <span class="hljs-string">'Sibiu'</span>, <span class="hljs-string">'RimnicuVilcea'</span>, <span class="hljs-string">'Pitesti'</span>, <span class="hljs-string">'Bucharest'</span> ]
assert.equal (aStarSearch travelingSalespersonProblem), <span class="hljs-literal">false</span></pre></div>
        
      
        
        <h2 id="optimisation">Optimisation</h2>
<p>Confer section 4.1, p. 121.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OptimizationProblem</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Problem</span></span>
  constructor: <span class="hljs-function"><span class="hljs-params">({ initialState, actions, result, @value })</span> -&gt;</span>
    <span class="hljs-keyword">super</span>
      initialState: initialState,
      actions: actions,
      result: result

  rootNode: <span class="hljs-function">-&gt;</span> {
    ...<span class="hljs-keyword">super</span>()
    value: @value @initialState
  }

  childNode: <span class="hljs-function"><span class="hljs-params">(node, action)</span> -&gt;</span> {
    ...<span class="hljs-keyword">super</span> node, action
    value: @value @result node.state, action
  }</pre></div>
        
      
        
        <h4 id="complete-state-8-queens-problem">Complete-State 8-Queens Problem</h4>
<p>Complete-state formulation of the 8-queens problem. From section 4.1.1, p. 122.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> completeStateEightQueensProblem = <span class="hljs-keyword">new</span> OptimizationProblem
  initialState: [
    [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
    [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
    [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
    [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
    [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
    [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
    [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
    [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  ]
  actions: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
    state.reduce (<span class="hljs-function"><span class="hljs-params">(total, row, y)</span> -&gt;</span> [
      ...total,
      ...[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>]
        .filter (x) -&gt; row[x] == <span class="hljs-number">0</span>
        .map (x) -&gt; [y, x]
    ]), []
  result: <span class="hljs-function"><span class="hljs-params">(state, [yMove, xMove])</span> -&gt;</span>
    state.map (row, y) -&gt;
      row.map (tile, x) -&gt;
        <span class="hljs-keyword">if</span> y == yMove
          <span class="hljs-keyword">if</span> x == xMove
            <span class="hljs-number">1</span>
          <span class="hljs-keyword">else</span>
            <span class="hljs-number">0</span>
        <span class="hljs-keyword">else</span>
          tile
  value: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span> -nrAttackedQueens state
<span class="hljs-function">
<span class="hljs-title">attacks</span> = <span class="hljs-params">([y1, x1], [y2, x2])</span> -&gt;</span>
  y1 == y2 <span class="hljs-keyword">or</span>
  x1 == x2 <span class="hljs-keyword">or</span>
  y2 - y1 == x2 - x1
<span class="hljs-function">
<span class="hljs-title">nrAttackedQueens</span> = <span class="hljs-params">(state)</span> -&gt;</span>
  combinations \
    state.map (row, y) -&gt;
      [y, row.indexOf <span class="hljs-number">1</span>]
    .reduce (<span class="hljs-function"><span class="hljs-params">(total, [q1, q2])</span> -&gt;</span>
      total + attacks(q1, q2) * <span class="hljs-number">1</span>), <span class="hljs-number">0</span>
<span class="hljs-function">
<span class="hljs-title">combinations</span> = <span class="hljs-params">(array)</span> -&gt;</span>
  array.reduce (<span class="hljs-function"><span class="hljs-params">(prev, a, i)</span> -&gt;</span> [
    ...prev,
    ...array
      .slice <span class="hljs-number">0</span>, i
      .map (b) -&gt; [a, b]
  ]), []</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>state = completeStateEightQueensProblem.initialState
assert.equal (completeStateEightQueensProblem.actions state).length, <span class="hljs-number">8</span> * (<span class="hljs-number">8</span> - <span class="hljs-number">1</span>)
assert.equal (completeStateEightQueensProblem.value state), -(<span class="hljs-number">8</span>**<span class="hljs-number">2</span> - <span class="hljs-number">8</span>) / <span class="hljs-number">2</span>

state = completeStateEightQueensProblem.result state, [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>]
assert.deepEqual state, [
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>],
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
]
assert.equal (completeStateEightQueensProblem.value state), -(<span class="hljs-number">28</span> - <span class="hljs-number">7</span>)</pre></div>
        
      
        
        <h4 id="hill-climbing-search">Hill-Climbing Search</h4>
<p>Confer section 4.1.1, p. 122.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> hillClimbingSearch = <span class="hljs-function"><span class="hljs-params">(problem)</span> -&gt;</span>
  recursiveHillClimbingSearch problem, problem.rootNode
<span class="hljs-function">
<span class="hljs-title">recursiveHillClimbingSearch</span> = <span class="hljs-params">(problem, current)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> (biggestValueNode problem.expand current).value &lt;= current.value
    current
  <span class="hljs-keyword">else</span>
    recursiveHillClimbingSearch problem, biggestValueNode problem.expand current
<span class="hljs-function">
<span class="hljs-title">biggestValueNode</span> = <span class="hljs-params">(array)</span> -&gt;</span>
  array.reduce (prev, node) -&gt;
    <span class="hljs-keyword">if</span> node.value &gt; prev.value
      node
    <span class="hljs-keyword">else</span>
      prev</pre></div>
        
      
        
        
        
      
        
        <p>solution = (hillClimbingSearch completeStateEightQueensProblem).state
assert.deepEqual solution, [
  [0, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 0, 0, 0, 0],
  [0, 0, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 0, 1, 0],
  [1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 0, 0, 0],
  [1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 0, 0]
] # TODO:</p>
<h4 id="simulated-annealing">Simulated Annealing</h4>
<p>Also known as <strong>Gradient Descent</strong>. From section 4.1.2, p. 126.</p>
<p>Parameter <code>random</code>: A random number generator function. Use seeded function for testing!</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> simulatedAnnealing = <span class="hljs-function"><span class="hljs-params">(problem, schedule, random = Math.random)</span> -&gt;</span>
  schedule ?= <span class="hljs-function"><span class="hljs-params">(time)</span> -&gt;</span> <span class="hljs-number">1</span> / time
<span class="hljs-function">  <span class="hljs-title">randEl</span> = <span class="hljs-params">(array)</span> -&gt;</span> array[Math.floor(random() * array.length)]
  current = problem.rootNode()
  time = <span class="hljs-number">1</span>
  temp = schedule <span class="hljs-number">1</span>
  next
  evalSlope
  <span class="hljs-keyword">while</span> temp &gt; <span class="hljs-number">0</span>
    temp = schedule time
    <span class="hljs-keyword">if</span> (temp == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">return</span> current
    next = randEl problem.expand current
    evalSlope = next.value - current.value
    <span class="hljs-keyword">if</span> evalSlope &gt; <span class="hljs-number">0</span>
      current = next
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Math.E**(evalSlope / temp) * random()) &gt; <span class="hljs-number">0.5</span>
      current = next
    time += <span class="hljs-number">1</span></pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
rand = gen.create <span class="hljs-string">'seedshrdlu4523'</span> <span class="hljs-comment"># random seed initialization for testing</span>
nSteps = <span class="hljs-number">2</span>
assert.equal \
  (simulatedAnnealing completeStateEightQueensProblem, <span class="hljs-function">(<span class="hljs-params">(t)</span> -&gt;</span> <span class="hljs-number">1</span>/t - <span class="hljs-number">1</span>/nSteps), rand.random).value, \
  <span class="hljs-number">-22</span></pre></div>
        
      
        
        <p>For <code>nSteps = 100</code>, this solves the problem (<code>value == -0</code>).
This is excluded from testing because it takes too long.</p>
<h2 id="games">Games</h2>
<p>Confer section 5.1, p. 162.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Game</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Problem</span></span>
  constructor: ({ 
    initialState, @player, actions, result, @terminalTest, utility, @heuristic = <span class="hljs-function">(<span class="hljs-params">(state)</span> -&gt;</span> <span class="hljs-number">0</span>)
  }) -&gt;
    <span class="hljs-keyword">super</span>
      initialState: initialState
      actions: actions
      result: result
    @_utility = utility

  utility: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
    @_utility state <span class="hljs-keyword">if</span> @terminalTest state

  rootNode: <span class="hljs-function">-&gt;</span> {
    ...<span class="hljs-keyword">super</span>()
    player: @player @initialState
  }

  childNode: <span class="hljs-function"><span class="hljs-params">(node, action)</span> -&gt;</span> {
    ...<span class="hljs-keyword">super</span> node, action
    player: @player @initialState
  }</pre></div>
        
      
        
        <h4 id="tic-tac-toe">Tic Tac Toe</h4>
<p>Confer section 5.1, p. 163.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> ticTacToe = <span class="hljs-keyword">new</span> Game
  initialState: [
    [<span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
    [<span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
    [<span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
  ]
  player: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> (count state, <span class="hljs-string">'x'</span>) &gt; (count state, <span class="hljs-string">'o'</span>)
      <span class="hljs-string">'o'</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-string">'x'</span>
  actions: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span> [
    [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>]
    [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
    [<span class="hljs-number">2</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>]
  ].filter ([y, x]) -&gt;
      state[y][x] == <span class="hljs-string">' '</span>
  result: <span class="hljs-function"><span class="hljs-params">(state, [yMove, xMove])</span> -&gt;</span>
    state.map (row, y) -&gt;
      row.map (tile, x) -&gt;
        <span class="hljs-keyword">if</span> y == yMove <span class="hljs-keyword">and</span> x == xMove
          ticTacToe.player state
        <span class="hljs-keyword">else</span>
          tile
  terminalTest: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
    (threeInaRow state, <span class="hljs-string">'x'</span>) <span class="hljs-keyword">or</span>
    (threeInaRow state, <span class="hljs-string">'o'</span>)
  utility: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
    <span class="hljs-number">1</span> * (threeInaRow state, <span class="hljs-string">'x'</span>)
<span class="hljs-function">
<span class="hljs-title">threeInaRow</span> = <span class="hljs-params">(state, p)</span> -&gt;</span> [
    [ [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>] ] <span class="hljs-comment"># horizontal</span>
    [ [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>] ] <span class="hljs-comment"># horizontal</span>
    [ [<span class="hljs-number">2</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>] ] <span class="hljs-comment"># horizontal</span>
    [ [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">0</span>] ] <span class="hljs-comment"># vertical</span>
    [ [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>] ] <span class="hljs-comment"># vertical</span>
    [ [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>] ] <span class="hljs-comment"># vertical</span>
    [ [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>] ] <span class="hljs-comment"># diagonal</span>
    [ [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">0</span>] ] <span class="hljs-comment"># diagonal</span>
  ].some (row) -&gt;
    row.every ([y, x]) -&gt;
      state[y][x] == p
<span class="hljs-function">
<span class="hljs-title">count</span> = <span class="hljs-params">(state, x)</span> -&gt;</span>
  state
    .flat()
    .filter (square) -&gt; square == x
    .length</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
state = ticTacToe.initialState

state = ticTacToe.result state, [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
assert.deepEqual state, [
  [<span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
  [<span class="hljs-string">'x'</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
  [<span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
]

state = ticTacToe.result state, [<span class="hljs-number">2</span>, <span class="hljs-number">0</span>]
assert.deepEqual state, [
  [<span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
  [<span class="hljs-string">'x'</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
  [<span class="hljs-string">'o'</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
]

state = ticTacToe.result state, [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]
assert.deepEqual state, [
  [<span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
  [<span class="hljs-string">'x'</span>, <span class="hljs-string">'x'</span>, <span class="hljs-string">' '</span>]
  [<span class="hljs-string">'o'</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
]

state = ticTacToe.result state, [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>]
assert.deepEqual state, [
  [<span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
  [<span class="hljs-string">'x'</span>, <span class="hljs-string">'x'</span>, <span class="hljs-string">' '</span>]
  [<span class="hljs-string">'o'</span>, <span class="hljs-string">'o'</span>, <span class="hljs-string">' '</span>]
]

assert <span class="hljs-keyword">not</span> ticTacToe.terminalTest state
assert.equal ticTacToe.utility(state), <span class="hljs-literal">undefined</span>

state = ticTacToe.result state, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
assert.deepEqual state, [
  [<span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>, <span class="hljs-string">' '</span>]
  [<span class="hljs-string">'x'</span>, <span class="hljs-string">'x'</span>, <span class="hljs-string">'x'</span>]
  [<span class="hljs-string">'o'</span>, <span class="hljs-string">'o'</span>, <span class="hljs-string">' '</span>]
]
assert ticTacToe.terminalTest state
assert.equal ticTacToe.utility(state), <span class="hljs-number">1</span></pre></div>
        
      
        
        <h4 id="minimax-algorithm">MiniMax Algorithm</h4>
<p>Confer section 5.2.1, p. 166.
<a href="https://github.com/aimacode/aima-pseudocode/blob/master/md/Minimax-Decision.md">Pseudocode</a>.</p>
<p>Changes to the pseudocode:</p>
<ul>
<li>A depth limit has been added (<code>Infinity</code> by default).</li>
<li><code>maximinDecision</code> has been added for player Min in analogy to <code>minimaxDecision</code> for player Max.
This is applicable to zero-sum games only. Note that the terms ‘maximin’ and ‘minimax’ are generally used inconsistently.</li>
<li>The notation is functional.</li>
</ul>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> minimaxDecision = <span class="hljs-function"><span class="hljs-params">(game, state, limit = Infinity)</span> -&gt;</span>
  game.actions state
    .map (action) -&gt;
      action: action
      outcome: minValue game, (game.result state, action), limit - <span class="hljs-number">1</span>
    .reduce (current, next) -&gt;
      <span class="hljs-keyword">if</span> next.outcome &gt; current.outcome
        next
      <span class="hljs-keyword">else</span>
        current

<span class="hljs-keyword">export</span> maximinDecision = <span class="hljs-function"><span class="hljs-params">(game, state, limit = Infinity)</span> -&gt;</span>
  game.actions state
    .map (action) -&gt;
      action: action
      outcome: maxValue game, (game.result state, action), limit - <span class="hljs-number">1</span>
    .reduce (current, next) -&gt;
      <span class="hljs-keyword">if</span> next.outcome &lt; current.outcome
        next
      <span class="hljs-keyword">else</span>
        current
<span class="hljs-function">
<span class="hljs-title">maxValue</span> = <span class="hljs-params">(game, state, limit)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> game.terminalTest state
    game.utility state
  <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">if</span> limit &lt; <span class="hljs-number">1</span>
      game.heuristic state
    <span class="hljs-keyword">else</span>
      game.actions state
        .reduce (<span class="hljs-function"><span class="hljs-params">(prev, current)</span> -&gt;</span>
          Math.max prev, (minValue game, (game.result state, current), limit - <span class="hljs-number">1</span>)), -Infinity
<span class="hljs-function">
<span class="hljs-title">minValue</span> = <span class="hljs-params">(game, state, limit)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> game.terminalTest state
    game.utility state
  <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">if</span> limit &lt; <span class="hljs-number">1</span>
      game.heuristic state
    <span class="hljs-keyword">else</span>
      game.actions state
        .reduce (<span class="hljs-function"><span class="hljs-params">(prev, current)</span> -&gt;</span>
          Math.min prev, (minValue game, (game.result state, current), limit - <span class="hljs-number">1</span>)), Infinity</pre></div>
        
      
        
        <p>The <code>minimaxDecision</code> algorithm is tested at the end of the next section, together with the <code>alphaBetaSearch</code> algorithm.</p>
<h4 id="alpha-beta-search">Alpha-Beta Search</h4>
<p>Confer section 5.3, p. 170. 
<a href="https://github.com/aimacode/aima-pseudocode/blob/master/md/Alpha-Beta-Search.md">Pseudocode</a>.</p>
<p>Changes to the pseudocode:</p>
<ul>
<li>A depth limit has been added (<code>Infinity</code> by default).</li>
<li><code>betaAlphaSearch</code> has been added for player Min in analogy to <code>alphaBetaSearch</code> for player Max.
This is applicable to zero-sum games only.</li>
</ul>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> alphaBetaSearch = <span class="hljs-function"><span class="hljs-params">(game, state, limit = Infinity)</span> -&gt;</span>
  game.actions state
    .map (action) -&gt;
      action: action,
      outcome: alphaBetaMinValue game, (game.result state, action), limit - <span class="hljs-number">1</span>, -Infinity, +Infinity
    .reduce (current, next) -&gt;
      <span class="hljs-keyword">if</span> next.outcome &gt; current.outcome
        next
      <span class="hljs-keyword">else</span>
        current

<span class="hljs-keyword">export</span> betaAlphaSearch = <span class="hljs-function"><span class="hljs-params">(game, state, limit = Infinity)</span> -&gt;</span>
  game.actions state
    .map (action) -&gt;
      action: action,
      outcome: alphaBetaMaxValue game, (game.result state, action), limit - <span class="hljs-number">1</span>, -Infinity, +Infinity
    .reduce (current, next) -&gt;
      <span class="hljs-keyword">if</span> next.outcome &gt; current.outcome
        next
      <span class="hljs-keyword">else</span>
        current
<span class="hljs-function">
<span class="hljs-title">alphaBetaMaxValue</span> = <span class="hljs-params">(game, state, limit, alpha, beta)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> game.terminalTest state
    game.utility state
  <span class="hljs-keyword">if</span> limit &lt; <span class="hljs-number">1</span>
    game.heuristic state
  v = -Infinity
  <span class="hljs-keyword">for</span> action <span class="hljs-keyword">in</span> game.actions state
    v = Math.max v, (alphaBetaMinValue game, (game.result state, action), limit, alpha, beta)
    <span class="hljs-keyword">if</span> v &gt;= beta
      v
    alpha = Math.max alpha, v
  v
<span class="hljs-function">
<span class="hljs-title">alphaBetaMinValue</span> = <span class="hljs-params">(game, state, limit, alpha, beta)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> game.terminalTest state
    game.utility state
  <span class="hljs-keyword">if</span> limit &lt; <span class="hljs-number">1</span>
    game.heuristic state
  v = +Infinity
  <span class="hljs-keyword">for</span> action <span class="hljs-keyword">in</span> game.actions state
    v = Math.min v, (alphaBetaMaxValue game, (game.result state, action), limit, alpha, beta)
    <span class="hljs-keyword">if</span> v &lt;= beta
      v
    alpha = Math.min alpha, v
  v</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
<span class="hljs-keyword">for</span> algorithm <span class="hljs-keyword">in</span> [minimaxDecision, alphaBetaSearch]
  state = [
    [<span class="hljs-string">'x'</span>, <span class="hljs-string">'o'</span>, <span class="hljs-string">'x'</span>]
    [<span class="hljs-string">'o'</span>, <span class="hljs-string">'x'</span>, <span class="hljs-string">'x'</span>]
    [<span class="hljs-string">' '</span>, <span class="hljs-string">'o'</span>, <span class="hljs-string">' '</span>]
  ]</pre></div>
        
      
        
        <p>player 2</p>

        
          <div class='highlight'><pre>  decision = algorithm ticTacToe, state
  state = ticTacToe.result state, decision.action
  assert.deepEqual state, [
    [<span class="hljs-string">'x'</span>, <span class="hljs-string">'o'</span>, <span class="hljs-string">'x'</span>]
    [<span class="hljs-string">'o'</span>, <span class="hljs-string">'x'</span>, <span class="hljs-string">'x'</span>]
    [<span class="hljs-string">'o'</span>, <span class="hljs-string">'o'</span>, <span class="hljs-string">' '</span>]
  ]
  assert <span class="hljs-keyword">not</span> ticTacToe.terminalTest state
  assert.equal ticTacToe.utility(state), <span class="hljs-literal">undefined</span></pre></div>
        
      
        
        <p>player 1</p>

        
          <div class='highlight'><pre>  decision = algorithm ticTacToe, state
  state = ticTacToe.result state, decision.action
  assert.deepEqual state, [
    [<span class="hljs-string">'x'</span>, <span class="hljs-string">'o'</span>, <span class="hljs-string">'x'</span>]
    [<span class="hljs-string">'o'</span>, <span class="hljs-string">'x'</span>, <span class="hljs-string">'x'</span>]
    [<span class="hljs-string">'o'</span>, <span class="hljs-string">'o'</span>, <span class="hljs-string">'x'</span>]
  ]
  assert ticTacToe.terminalTest state
  assert.equal ticTacToe.utility(state), <span class="hljs-number">1</span></pre></div>
        
      
        
        <h2 id="constraint-satisfaction">Constraint Satisfaction</h2>
<p>Confer section 6.1, p. 202.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConstraintSatisfactionProblem</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SearchProblem</span></span>
  constructor: <span class="hljs-function"><span class="hljs-params">({ domains, constraints })</span> -&gt;</span>
<span class="hljs-function">    <span class="hljs-title">get</span> = <span class="hljs-params">(pairList, key)</span> -&gt;</span>
      pairList.find(<span class="hljs-function"><span class="hljs-params">([key2, value])</span> -&gt;</span> key == key2)[<span class="hljs-number">1</span>]
    <span class="hljs-keyword">super</span>
      initialState: []
      actions: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
        <span class="hljs-keyword">if</span> state.length &lt; domains.length
          domains[state.length][<span class="hljs-number">1</span>]
            .map (value) -&gt;
              [domains[state.length][<span class="hljs-number">0</span>], value]
        <span class="hljs-keyword">else</span>
          []
      result: <span class="hljs-function"><span class="hljs-params">(state, action)</span> -&gt;</span> [...state, action]
      stepCost: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span> <span class="hljs-number">0</span>
      goalTest: <span class="hljs-function"><span class="hljs-params">(state)</span> -&gt;</span>
        state.length == domains.length <span class="hljs-keyword">and</span>
        (domains.every ([varName, domain]) -&gt;
          domain.some (v) -&gt;
            deepEqual v, (get state, varName)) <span class="hljs-keyword">and</span>
        constraints.every ([varList, constraint]) -&gt;
          varList.every (vars) -&gt;
            constraint \
              ...vars.map (varName) -&gt;
                get state, varName
    @domains     = domains
    @constraints = constraints

  variables: <span class="hljs-function">-&gt;</span>
    @domains.keys()

  satisfied: <span class="hljs-function"><span class="hljs-params">(solution)</span> -&gt;</span>
    @goalTest solution</pre></div>
        
      
        
        <h4 id="map-coloring-problem">Map Coloring Problem</h4>
<p>Confer section 6.1.1, p. 203.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> mapColoringProblem = <span class="hljs-keyword">new</span> ConstraintSatisfactionProblem
  domains: [<span class="hljs-string">'WA'</span>, <span class="hljs-string">'NT'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'NSW'</span>, <span class="hljs-string">'V'</span>, <span class="hljs-string">'SA'</span>, <span class="hljs-string">'T'</span>] \
    .map (state) -&gt; [state, [<span class="hljs-string">'red'</span>, <span class="hljs-string">'green'</span>, <span class="hljs-string">'blue'</span>] ]
  constraints: [
    [
      [
        [<span class="hljs-string">'SA'</span> , <span class="hljs-string">'WA'</span> ]
        [<span class="hljs-string">'SA'</span> , <span class="hljs-string">'NT'</span> ]
        [<span class="hljs-string">'SA'</span> , <span class="hljs-string">'Q'</span>  ]
        [<span class="hljs-string">'SA'</span> , <span class="hljs-string">'NSW'</span>]
        [<span class="hljs-string">'SA'</span> , <span class="hljs-string">'V'</span>  ]
        [<span class="hljs-string">'WA'</span> , <span class="hljs-string">'NT'</span> ]
        [<span class="hljs-string">'NT'</span> , <span class="hljs-string">'Q'</span>  ]
        [<span class="hljs-string">'Q'</span>  , <span class="hljs-string">'NSW'</span>]
        [<span class="hljs-string">'NSW'</span>, <span class="hljs-string">'V'</span>  ]
      ]
      (a, b) -&gt; a != b
    ]
  ]</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
state = mapColoringProblem.initialState
assert.deepEqual state, []
assert <span class="hljs-keyword">not</span> mapColoringProblem.satisfied state
assert.deepEqual (mapColoringProblem.actions state), [[<span class="hljs-string">'WA'</span>, <span class="hljs-string">'red'</span>], [<span class="hljs-string">'WA'</span>, <span class="hljs-string">'green'</span>], [<span class="hljs-string">'WA'</span>, <span class="hljs-string">'blue'</span>]]

state = mapColoringProblem.result state, [<span class="hljs-string">'WA'</span>, <span class="hljs-string">'red'</span>]
assert.deepEqual state, [[<span class="hljs-string">'WA'</span>, <span class="hljs-string">'red'</span>]]
assert <span class="hljs-keyword">not</span> mapColoringProblem.satisfied state
assert.deepEqual (mapColoringProblem.actions state), [[<span class="hljs-string">'NT'</span>, <span class="hljs-string">'red'</span>], [<span class="hljs-string">'NT'</span>, <span class="hljs-string">'green'</span>], [<span class="hljs-string">'NT'</span>, <span class="hljs-string">'blue'</span>]]

state = mapColoringProblem.result state, [<span class="hljs-string">'NT'</span>, <span class="hljs-string">'green'</span>]
assert.deepEqual state, [[<span class="hljs-string">'WA'</span>, <span class="hljs-string">'red'</span>], [<span class="hljs-string">'NT'</span>, <span class="hljs-string">'green'</span>]]
assert <span class="hljs-keyword">not</span> mapColoringProblem.satisfied state
assert.deepEqual (mapColoringProblem.actions state), [[<span class="hljs-string">'Q'</span>, <span class="hljs-string">'red'</span>], [<span class="hljs-string">'Q'</span>, <span class="hljs-string">'green'</span>], [<span class="hljs-string">'Q'</span>, <span class="hljs-string">'blue'</span>]]

solution = [
  [<span class="hljs-string">'WA'</span> , <span class="hljs-string">'blue'</span> ]
  [<span class="hljs-string">'NT'</span> , <span class="hljs-string">'green'</span>]
  [<span class="hljs-string">'Q'</span>  , <span class="hljs-string">'red'</span>  ]
  [<span class="hljs-string">'NSW'</span>, <span class="hljs-string">'green'</span>]
  [<span class="hljs-string">'V'</span>  , <span class="hljs-string">'red'</span>  ]
  [<span class="hljs-string">'SA'</span> , <span class="hljs-string">'blue'</span> ]
  [<span class="hljs-string">'T'</span>  , <span class="hljs-string">'red'</span>  ]
]
assert <span class="hljs-keyword">not</span> mapColoringProblem.satisfied solution

solution = [
  [<span class="hljs-string">'WA'</span> , <span class="hljs-string">'red'</span> ]
  [<span class="hljs-string">'NT'</span> , <span class="hljs-string">'green'</span>]
  [<span class="hljs-string">'Q'</span>  , <span class="hljs-string">'red'</span>  ]
  [<span class="hljs-string">'NSW'</span>, <span class="hljs-string">'green'</span>]
  [<span class="hljs-string">'V'</span>  , <span class="hljs-string">'red'</span>  ]
  [<span class="hljs-string">'SA'</span> , <span class="hljs-string">'green'</span> ]
  [<span class="hljs-string">'T'</span>  , <span class="hljs-string">'red'</span>  ]
]
assert <span class="hljs-keyword">not</span> mapColoringProblem.satisfied solution

solution = [
  [<span class="hljs-string">'WA'</span> , <span class="hljs-string">'red'</span>  ]
  [<span class="hljs-string">'NT'</span> , <span class="hljs-string">'green'</span>]
  [<span class="hljs-string">'Q'</span>  , <span class="hljs-string">'red'</span>  ]
  [<span class="hljs-string">'NSW'</span>, <span class="hljs-string">'green'</span>]
  [<span class="hljs-string">'V'</span>  , <span class="hljs-string">'blue'</span> ]
  [<span class="hljs-string">'SA'</span> , <span class="hljs-string">'blue'</span> ]
  [<span class="hljs-string">'T'</span>  , <span class="hljs-string">'red'</span>  ]
]
assert <span class="hljs-keyword">not</span> mapColoringProblem.satisfied solution

solution = [
  [<span class="hljs-string">'WA'</span> , <span class="hljs-string">'red'</span>  ]
  [<span class="hljs-string">'NT'</span> , <span class="hljs-string">'green'</span>]
  [<span class="hljs-string">'Q'</span>  , <span class="hljs-string">'red'</span>  ]
  [<span class="hljs-string">'NSW'</span>, <span class="hljs-string">'green'</span>]
  [<span class="hljs-string">'V'</span>  , <span class="hljs-string">'red'</span>  ]
  [<span class="hljs-string">'SA'</span> , <span class="hljs-string">'blue'</span> ]
  [<span class="hljs-string">'T'</span>  , <span class="hljs-string">'red'</span>  ]
]
assert mapColoringProblem.satisfied solution

assert.deepEqual (depthFirstSearch mapColoringProblem).state, [
  [<span class="hljs-string">'WA'</span> , <span class="hljs-string">'blue'</span> ]
  [<span class="hljs-string">'NT'</span> , <span class="hljs-string">'green'</span>]
  [<span class="hljs-string">'Q'</span>  , <span class="hljs-string">'blue'</span> ]
  [<span class="hljs-string">'NSW'</span>, <span class="hljs-string">'green'</span>]
  [<span class="hljs-string">'V'</span>  , <span class="hljs-string">'blue'</span> ]
  [<span class="hljs-string">'SA'</span> , <span class="hljs-string">'red'</span>  ]
  [<span class="hljs-string">'T'</span>  , <span class="hljs-string">'blue'</span> ]
]</pre></div>
        
      
        
        <h4 id="constraint-satisfaction-8-queens-problem">Constraint-Satisfaction 8-Queens Problem</h4>
<p>Constraint-satisfaction formulation of the eight-queens problem.
Confer section 6.1.3, p. 205.</p>

        
          <div class='highlight'><pre>queens = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>]
<span class="hljs-function"><span class="hljs-title">attacks</span> = <span class="hljs-params">([y1, x1], [y2, x2])</span> -&gt;</span> 
  y1 == y2 <span class="hljs-keyword">or</span>
  x1 == x2 <span class="hljs-keyword">or</span>
  y2 - y1 == x2 - x1

<span class="hljs-keyword">export</span> constraintSatisfactionEightQueensProblem = <span class="hljs-keyword">new</span> ConstraintSatisfactionProblem
  domains: queens.map (queen) -&gt; [
    queen
    [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>].flatMap (y) -&gt;
      [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>].map (x) -&gt;
        [y, x]
  ]
  constraints: [
    [
      queens.flatMap (queen1) -&gt;
        queens
          .filter (queen2) -&gt; queen1 != queen2
          .map (queen2) -&gt; [queen1, queen2]
      (a, b) -&gt; <span class="hljs-keyword">not</span> attacks a, b
    ]
  ]</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
solution = [
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
].map (row, y) -&gt; [y, [y, row.findIndex (x) -&gt; x == <span class="hljs-number">1</span>] ]
assert <span class="hljs-keyword">not</span> constraintSatisfactionEightQueensProblem.satisfied solution

solution = [
  [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
  [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
].map (row, y) -&gt; [y, [y, row.findIndex (x) -&gt; x == <span class="hljs-number">1</span>] ]
assert constraintSatisfactionEightQueensProblem.satisfied solution</pre></div>
        
      
        
        <h4 id="node-consistency">Node Consistency</h4>
<p>Confer section 6.2.1, p. 208.</p>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> makeNodeConsistent = <span class="hljs-function"><span class="hljs-params">(problem)</span> -&gt;</span>
  <span class="hljs-keyword">new</span> ConstraintSatisfactionProblem
    domains: problem.domains.map ([varName, domain]) -&gt;
      [
        varName,
        domain.filter (value) -&gt;
          applicableUnaryConstraints problem.constraints, varName
            .every ([varList, constraintFunc]) -&gt;
              constraintFunc value
      ]
    constraints: nonUnaryConstraints problem.constraints
<span class="hljs-function">
<span class="hljs-title">applicableUnaryConstraints</span> = <span class="hljs-params">(constraints, varName)</span> -&gt;</span>
  unaryConstraints constraints
    .filter (constraint) -&gt;
      constraint[<span class="hljs-number">0</span>].some (varName2) -&gt;
        varName2 == varName
<span class="hljs-function">
<span class="hljs-title">unaryConstraints</span> = <span class="hljs-params">(constraints)</span> -&gt;</span>
  constraints.filter (constraint) -&gt; constraint[<span class="hljs-number">1</span>].length == <span class="hljs-number">1</span>
<span class="hljs-function">
<span class="hljs-title">nonUnaryConstraints</span> = <span class="hljs-params">(constraints)</span> -&gt;</span>
  constraints.filter (constraint) -&gt; constraint[<span class="hljs-number">1</span>].length &gt; <span class="hljs-number">1</span></pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
problem = <span class="hljs-keyword">new</span> ConstraintSatisfactionProblem
  domains: [
    [<span class="hljs-string">'Northern Australia'</span>, [<span class="hljs-string">'red'</span>, <span class="hljs-string">'blue'</span>, <span class="hljs-string">'green'</span>] ]
    [<span class="hljs-string">'Southern Australia'</span>, [<span class="hljs-string">'red'</span>, <span class="hljs-string">'blue'</span>, <span class="hljs-string">'green'</span>] ]
  ]
  constraints: [
    [[<span class="hljs-string">'Northern Australia'</span>, <span class="hljs-string">'Southern Australia'</span>], <span class="hljs-function"><span class="hljs-params">(a, b)</span> -&gt;</span> a != b]
    [[<span class="hljs-string">'Southern Australia'</span>], <span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span> a != <span class="hljs-string">'green'</span>]
  ]

problem = makeNodeConsistent problem
assert.deepEqual problem.domains, [
  [<span class="hljs-string">'Northern Australia'</span>, [<span class="hljs-string">'red'</span>, <span class="hljs-string">'blue'</span>, <span class="hljs-string">'green'</span>]]
  [<span class="hljs-string">'Southern Australia'</span>, [<span class="hljs-string">'red'</span>, <span class="hljs-string">'blue'</span>]]
]</pre></div>
        
      
        
        <h2 id="logic">Logic</h2>
<p>The following syntax of propositional logic is currently used (in deviation from the book syntax).
It would be desirable to refactor the syntax to match the book.</p>
<ul>
<li>Operator symbols: <code>~</code>, <code>&amp;</code>, <code>|</code>, <code>&gt;</code>, <code>=</code></li>
<li>Truth symbols: <code>T</code>, <code>F</code></li>
<li>Compulsory brackets around each expression. This is pretty ugly.</li>
</ul>
<p>Confer section 7.4.1, p. 244.</p>
<h4 id="syntax-of-propositional-logic">Syntax of Propositional Logic</h4>

        
          <div class='highlight'><pre><span class="hljs-keyword">export</span> plParse = <span class="hljs-function"><span class="hljs-params">(sentence, vars)</span> -&gt;</span>
  recursiveParse sentence.split(<span class="hljs-string">''</span>), vars

unaryOperators  = [<span class="hljs-string">'~'</span>]
binaryOperators = [<span class="hljs-string">'&amp;'</span>, <span class="hljs-string">'|'</span>, <span class="hljs-string">'&gt;'</span>, <span class="hljs-string">'='</span>]
operators       = [...unaryOperators, ...binaryOperators]
<span class="hljs-function">
<span class="hljs-title">recursiveParse</span> = <span class="hljs-params">(sentence, vars)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> (levels sentence)[sentence.length - <span class="hljs-number">1</span>] == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span>
  sentence[<span class="hljs-number">0</span>] == <span class="hljs-string">'('</span> <span class="hljs-keyword">and</span>
  sentence[sentence.length - <span class="hljs-number">1</span>] == <span class="hljs-string">')'</span>
    <span class="hljs-keyword">if</span> (levels sentence).some (level) -&gt; level &gt; <span class="hljs-number">1</span>
      <span class="hljs-keyword">if</span> (operatorIndex sentence) &gt; <span class="hljs-number">-1</span>
        [
          (sentence.slice (operatorIndex sentence), (operatorIndex sentence) + <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>],
          ...<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> unaryOperators.includes sentence[operatorIndex sentence]
            [recursiveParse (sentence.slice <span class="hljs-number">1</span>, operatorIndex sentence), vars]
          <span class="hljs-keyword">else</span>
            []
          recursiveParse (sentence.slice (operatorIndex sentence) + <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>)
        ]
      <span class="hljs-keyword">else</span>
        recursiveParse sentence.slice <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> operators.some (operator) -&gt; sentence.includes operator
      <span class="hljs-string">'ERROR'</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> sentence.length == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> sentence[<span class="hljs-number">1</span>] == <span class="hljs-string">'T'</span>
      <span class="hljs-literal">true</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> sentence.length == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> sentence[<span class="hljs-number">1</span>] == <span class="hljs-string">'F'</span>
      <span class="hljs-literal">false</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> vars == <span class="hljs-string">'undefined'</span> <span class="hljs-keyword">or</span>
    vars.includes (sentence.slice <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>).join <span class="hljs-string">''</span>
      (sentence.slice <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>).join <span class="hljs-string">''</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-string">'UNDEFINED'</span>
  <span class="hljs-keyword">else</span>
    <span class="hljs-string">'ERROR'</span>
<span class="hljs-function">
<span class="hljs-title">levels</span> = <span class="hljs-params">(sentence)</span> -&gt;</span>
  sentence
    .map (char) -&gt;
      <span class="hljs-keyword">if</span> char == <span class="hljs-string">'('</span>
        <span class="hljs-number">1</span>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> char == <span class="hljs-string">')'</span>
        <span class="hljs-number">-1</span>
      <span class="hljs-keyword">else</span>
        <span class="hljs-number">0</span>
    .reduce (<span class="hljs-function"><span class="hljs-params">(prev, derivation)</span> -&gt;</span> [
      ...prev,
      prev[prev.length - <span class="hljs-number">1</span>] + derivation
    ]), [<span class="hljs-number">0</span>]
    .slice(<span class="hljs-number">1</span>)
<span class="hljs-function">
<span class="hljs-title">operatorIndex</span> = <span class="hljs-params">(sentence)</span> -&gt;</span>
  sentence.findIndex (char, i) -&gt;
    (levels sentence)[i] == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> operators.includes char</pre></div>
        
      
        
        
        
          <div class='highlight'><pre>
<span class="hljs-keyword">for</span> [proposition, syntax] <span class="hljs-keyword">in</span> [
  [ [ <span class="hljs-string">'A'</span>                   ], <span class="hljs-string">'ERROR'</span>                            ]
  [ [ <span class="hljs-string">'(A'</span>                  ], <span class="hljs-string">'ERROR'</span>                            ]
  [ [ <span class="hljs-string">'A)'</span>                  ], <span class="hljs-string">'ERROR'</span>                            ]
  [ [ <span class="hljs-string">'(A)'</span>, [<span class="hljs-string">'B'</span>]          ], <span class="hljs-string">'UNDEFINED'</span>                        ]
  [ [ <span class="hljs-string">'(A)'</span>, [<span class="hljs-string">'A'</span>]          ], <span class="hljs-string">'A'</span>                                ]
  [ [ <span class="hljs-string">'(A)'</span>                 ], <span class="hljs-string">'A'</span>                                ]
  [ [ <span class="hljs-string">'(T)'</span>                 ], <span class="hljs-literal">true</span>                               ]
  [ [ <span class="hljs-string">'(F)'</span>                 ], <span class="hljs-literal">false</span>                              ]
  [ [ <span class="hljs-string">'((A))'</span>               ], <span class="hljs-string">'A'</span>                                ]
  [ [ <span class="hljs-string">'(((A)))'</span>             ], <span class="hljs-string">'A'</span>                                ]
  [ [ <span class="hljs-string">'~(A)'</span>                ], <span class="hljs-string">'ERROR'</span>                            ]
  [ [ <span class="hljs-string">'(~A)'</span>                ], <span class="hljs-string">'ERROR'</span>                            ]
  [ [ <span class="hljs-string">'(~(A))'</span>              ], [<span class="hljs-string">'~'</span>, <span class="hljs-string">'A'</span>]                         ]
  [ [ <span class="hljs-string">'((A)&amp;(B))'</span>           ], [<span class="hljs-string">'&amp;'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]                    ]
  [ [ <span class="hljs-string">'((A)|(B))'</span>           ], [<span class="hljs-string">'|'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]                    ]
  [ [ <span class="hljs-string">'((A)&gt;(B))'</span>           ], [<span class="hljs-string">'&gt;'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]                    ]
  [ [ <span class="hljs-string">'((A)=(B))'</span>           ], [<span class="hljs-string">'='</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>]                    ]
  [ [ <span class="hljs-string">'((~(A))&amp;(B))'</span>        ], [<span class="hljs-string">'&amp;'</span>, [<span class="hljs-string">'~'</span>, <span class="hljs-string">'A'</span>], <span class="hljs-string">'B'</span>]             ]
  [ [ <span class="hljs-string">'((A)&amp;(~(B)))'</span>        ], [<span class="hljs-string">'&amp;'</span>, <span class="hljs-string">'A'</span>, [<span class="hljs-string">'~'</span>, <span class="hljs-string">'B'</span>]]             ]
  [ [ <span class="hljs-string">'(((A)|(B))&amp;(~(C)))'</span>  ], [<span class="hljs-string">'&amp;'</span>, [<span class="hljs-string">'|'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>], [<span class="hljs-string">'~'</span>, <span class="hljs-string">'C'</span>]] ]
  [ [ <span class="hljs-string">'(((A)|(B)&amp;(~(C)))'</span>   ], <span class="hljs-string">'ERROR'</span>                            ]
  [ [ <span class="hljs-string">'((A)|(B))&amp;(~(C)))'</span>   ], <span class="hljs-string">'ERROR'</span>                            ]
  [ [ <span class="hljs-string">'(((A)|(B)))&amp;(~(C)))'</span> ], <span class="hljs-string">'ERROR'</span>                            ]
  [ [ <span class="hljs-string">'(((A)|(B))&amp;(~(C))))'</span> ], <span class="hljs-string">'ERROR'</span>                            ]
]
  assert.deepEqual (plParse ...proposition), syntax</pre></div>
        
      
      <div class="fleur">h</div>
    </div>
  </div>
</body>
</html>
